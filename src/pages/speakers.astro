---
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Get all speakers and sort by name
const speakers = await getCollection('speakers');
const sortedSpeakers = speakers.sort((a, b) => a.data.name.localeCompare(b.data.name));

// Format the slug for dynamic routing
function formatSlug(name: string) {
  return name.toLowerCase().replace(/ /g, '-');
}
---

<Layout title="Speakers">
  <div class="container mx-auto px-4 py-16 md:py-24">
    <h1 class="text-5xl font-extrabold mb-8 text-center">BSides Roanoke Speakers</h1>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 w-full max-w-6xl">
    {sortedSpeakers.map((speaker: any) => (
      <div class="bg-gray-800 rounded-3xl p-6 flex flex-col items-center text-center border border-gray-700 hover:border-accent-blue transition-colors">
        <div class="w-32 h-32 rounded-full overflow-hidden mb-4 border-2 border-gray-600">
          <div class="flex items-center justify-center w-full h-full bg-gray-700 text-gray-400">
            {speaker.data.name.split(' ').map((n, index) => (
              <span key={index} class="text-3xl font-bold">{n[0]}</span>
            ))}
          </div>
        </div>
        <h2 class="text-2xl font-bold mb-2">{speaker.data.name}</h2>
        <p class="text-gray-400 mb-1">{speaker.data.title}</p>
        <a href={`/speakers/${formatSlug(speaker.data.name)}`} class="mt-4 inline-block px-6 py-3 bg-accent-blue text-gray-900 rounded-full font-bold hover:bg-opacity-80 transition-colors glow-shadow">
          View Profile
        </a>
      </div>
    ))}
    </div>
  </div>
</Layout>
