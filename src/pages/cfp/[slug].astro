---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Markdoc from '@markdoc/markdoc';

export async function getStaticPaths() {
  const cfps = await getCollection('cfp');
  return cfps.map(cfp => ({
    params: { slug: cfp.id.replace('.md', '') },
    props: { cfp },
  }));
}

const { cfp } = Astro.props;
const { data, body } = cfp;
const renderedBody = Markdoc.renderers.html(Markdoc.transform(Markdoc.parse(body || '')));
---
<Layout title={data.title}>
  <section class="container mx-auto px-4 py-16 md:py-24">
    <div class="max-w-3xl mx-auto text-center">
      <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4">{data.title}</h1>
      <p class="text-xl text-gray-400 mb-8">
        Submissions Close: <span class="font-semibold text-accent-green">{new Date(data.closeDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
      </p>

      <div class="bg-gray-800 rounded-2xl p-8 border border-gray-700 text-left mb-8">
        <div class="prose prose-invert max-w-none" set:html={renderedBody} />
      </div>

      <a 
        href={data.link} 
        target="_blank" 
        rel="noopener noreferrer"
        class="inline-block px-10 py-4 bg-accent-blue text-gray-900 rounded-full font-bold text-lg hover:bg-opacity-80 transition-colors glow-shadow"
      >
        Submit Your Talk
      </a>
    </div>
  </section>
</Layout>